"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function e(e,t){for(var a=0;a<t.length;a++){var i=t[a];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,a,i){return a&&e(t.prototype,a),i&&e(t,i),t}}(),_wepy=require("./../npm/wepy/lib/wepy.js"),_wepy2=_interopRequireDefault(_wepy),_api=require("./../api/index.js"),_wepyComToast=require("./../npm/wepy-com-toast/toast.js"),_wepyComToast2=_interopRequireDefault(_wepyComToast),_lvUtil=require("./../npm/lv-util/lib/index.common.js"),EditResume=function(e){function t(){var e,a,i,o;_classCallCheck(this,t);for(var n=arguments.length,s=Array(n),r=0;r<n;r++)s[r]=arguments[r];return a=i=_possibleConstructorReturn(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(s))),i.config={navigationBarTitleText:"编辑简历"},i.components={toast:_wepyComToast2.default},i.data={info:{},radioItems:[{name:"男",value:"男"},{name:"女",value:"女"}],days:[],date:"1997-11-11",star:4,educations:[{name:"大专",value:"大专"},{name:"本科",value:"本科"},{name:"硕士",value:"硕士"},{name:"博士",value:"博士"}],types:[{name:"快速兼职",value:"快速兼职"},{name:"普通兼职",value:"普通兼职"},{name:"长期兼职",value:"长期兼职"}],stars:[1,2,3,4,5]},i.methods={change:function(e,t){"email"===e&&((0,_lvUtil.isEmail)(t.detail.value)||this.$invoke("toast","show",{title:"邮箱格式错误",img:"../assets/error.png"})),"tel"===e&&((0,_lvUtil.isMobile)(t.detail.value)||this.$invoke("toast","show",{title:"手机号码格式错误",img:"../assets/error.png"})),console.log(t),this.info[e]=t.detail.value},checkboxChange:function(e){var t=(e.detail.value||[]).map(Number);this.days.forEach(function(e){e.highlight=-1!==t.indexOf(e.day)}),this.info.workday=t.join(","),this.$apply()},typeChange:function(e){var t=this,a=e.detail.value;this.info.job=a.join(","),a.forEach(function(e){"快速兼职"===e?t.types[0].checked=!0:"普通兼职"===e?t.types[1].checked=!0:"长期兼职"===e&&(t.types[2].checked=!0)}),this.$apply()},changeSkill:function(e,t,a){if(console.log(a.detail.value),"value"===e)return void(this.info.ability[t][e]=this.stars[a.detail.value]);this.info.ability[t][e]=Number(a.detail.value)},addSkill:function(){this.info.ability.push({label:"",value:4}),this.$apply()},changeCurrency:function(e,t){var a=this.info.currency[e].key;this.info[a]=this.info.currency[e].value=this.stars[t.detail.value],this.$apply()},chooseImg:function(){var e=this;wx.chooseImage({count:1,success:function(t){var a=t.tempFilePaths[0];console.log(a),(0,_api.upload)(a).then(function(t){console.log(t),t&&"string"==typeof t.data&&(t.data=JSON.parse(t.data)),e.$invoke("toast","show",{title:t.data.msg,img:500===t.data.code?"../assets/error.png":"../assets/profile/check.png"}),t.data&&t.data.fileName&&(e.info.imgArray=t.data.fileName),e.$apply()})},fail:function(){this.$invoke("toast","show",{title:"选择图片失败",img:"../assets/error.png"})}})},save:function(){var e=this;(0,_api.updateResume)(this.info).then(function(t){e.$invoke("toast","show",{title:t.msg,img:0===t.code?"../assets/profile/check.png":"../assets/error.png"})})}},o=a,_possibleConstructorReturn(i,o)}return _inherits(t,e),_createClass(t,[{key:"onLoad",value:function(){var e=this;(0,_api.getResume)().then(function(t){if(500===t.code||!t.data)return console.log(t,"res"),void e.$invoke("toast","show",{title:t.msg,img:0===t.code?"../assets/profile/check.png":"../assets/error.png"});t.data.hope=(t.data.workday||"").split(",");for(var a=1;a<=7;a++)e.days.push({day:a,highlight:-1!==t.data.hope.indexOf(a.toString())});(e.info.job||"").split(",").forEach(function(t){"长期"===t?e.types[0].checked=!0:"短期"===t&&(e.types[1].checked=!0)}),t.data.ability=t.data.ability||[];var i=t.data.currency=[];i.push({label:"工作效率",key:"efficiency",value:t.data.efficiency}),i.push({label:"沟通能力",key:"communication",value:t.data.communication}),i.push({label:"专业技能",key:"major",value:t.data.major}),i.push({label:"工作状态",key:"workstatus",value:t.data.workstatus}),i.push({label:"诚信守时",key:"honest",value:t.data.honest}),e.info=t.data,e.$apply()})}}]),t}(_wepy2.default.page);Page(require("./../npm/wepy/lib/wepy.js").default.$createPage(EditResume,"pages/edit-resume"));