"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function e(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,i,a){return i&&e(t.prototype,i),a&&e(t,a),t}}(),_wepy=require("./../npm/wepy/lib/wepy.js"),_wepy2=_interopRequireDefault(_wepy),_api=require("./../api/index.js"),_wepyComToast=require("./../npm/wepy-com-toast/toast.js"),_wepyComToast2=_interopRequireDefault(_wepyComToast),_lvUtil=require("./../npm/lv-util/lib/index.common.js"),EditResume=function(e){function t(){var e,i,a,o;_classCallCheck(this,t);for(var n=arguments.length,s=Array(n),r=0;r<n;r++)s[r]=arguments[r];return i=a=_possibleConstructorReturn(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(s))),a.config={navigationBarTitleText:"发布职位"},a.components={toast:_wepyComToast2.default},a.data={info:{img:"",industry:"",title:"",intro:"",rowSalary:[],contact:"",post:"",tel:"",stick:0,_stick:!1,job:"",workingTime:"",workTimeDay:"",workTimeWeek:"",salary:"",wageProtection:0,_wageProtection:!1,city:"",education:"",targetdegree:"",site:"",responsibility:"",company:"",companyname:""},salarys:[],educations:[{name:"大专",value:"大专"},{name:"本科",value:"本科"},{name:"硕士",value:"硕士"},{name:"博士",value:"博士"}],days:[],job:["快速兼职","普通兼职","长期兼职"],workTimeDay:[],workTimeWeek:[],stars:[1,2,3,4,5]},a.methods={change:function(e,t){"email"===e&&((0,_lvUtil.isEmail)(t.detail.value)||this.$invoke("toast","show",{title:"邮箱格式错误",img:"../assets/error.png"})),"tel"===e&&((0,_lvUtil.isMobile)(t.detail.value)||this.$invoke("toast","show",{title:"手机号码格式错误",img:"../assets/error.png"})),this.info[e]=t.detail.value,"_wageProtection"===e&&(this.info.wageProtection=t.detail.value?1:0),"_stick"===e&&(this.info.stick=t.detail.value?1:0)},checkboxChange:function(e){var t=(e.detail.value||[]).map(Number);this.days.forEach(function(e){e.highlight=-1!==t.indexOf(e.day)}),this.info.workday=t.join(","),this.$apply()},chooseImg:function(){var e=this;wx.chooseImage({count:1,success:function(t){var i=t.tempFilePaths[0];console.log(i),(0,_api.upload)(i).then(function(t){console.log(t),t&&"string"==typeof t.data&&(t.data=JSON.parse(t.data)),e.$invoke("toast","show",{title:t.data.msg,img:500===t.data.code?"../assets/error.png":"../assets/profile/check.png"}),t.data&&t.data.fileName&&("string"==typeof t.data.fileName&&(t.data.fileName=[t.data.fileName]),e.info.img=t.data.fileName[0]),e.$apply()})},fail:function(){this.$invoke("toast","show",{title:"选择图片失败",img:"../assets/error.png"})}})},save:function(){var e=this,t=this.info;return t.img&&t.industry&&t.title&&t.intro&&t.salary&&t.contact&&t.tel&&t.job&&t.workingTime&&t.workTimeDay&&t.workTimeWeek&&t.city&&t.education&&t.targetdegree&&t.site?t.responsibility.length<20||t.company.length<20?void this.$invoke("toast","show",{title:"职位描述和公司简介不可少于20字",img:"../assets/error"}):void(0,_api.publishJob)(t).then(function(t){e.$invoke("toast","show",{title:t.msg,img:500===t.code?"../assets/error.png":"../assets/profile/check.png"}),console.log(t)}):void this.$invoke("toast","show",{title:"请补全信息，带星号为必填",img:"../assets/error"})},changePicker:function(e,t){this.info[e]="workTimeDay"===e?this[e][t.detail.value]+"小时":"workTimeWeek"===e?this[e][t.detail.value]+"天":this[e][t.detail.value]},changeSalary:function(e){var t=e.detail.value;if(t[0]>t[1]){var i=t[0];t[0]=t[1],t[1]=i}var a=[this.salarys[0][t[0]],this.salarys[1][t[1]]];this.info.rowSalary=a,this.info.salary=a.join("-")+"元/月"},extraSalary:function(){this.info.salary="面议",this.info.rowSalary=[],this.$apply()}},o=i,_possibleConstructorReturn(a,o)}return _inherits(t,e),_createClass(t,[{key:"onLoad",value:function(){this.handleInfo(this.info);for(var e=[],t=1;t<50;t++)e.push(1e3*t);this.salarys=[e,e]}},{key:"handleInfo",value:function(e){e.hope=(e.workday||"").split(",");for(var t=1;t<=7;t++)this.days.push({day:t,highlight:-1!==e.hope.indexOf(t.toString())}),this.workTimeWeek.push(t);for(var i=1;i<=24;i++)this.workTimeDay.push(i);this.$apply()}}]),t}(_wepy2.default.page);Page(require("./../npm/wepy/lib/wepy.js").default.$createPage(EditResume,"pages/job-release"));